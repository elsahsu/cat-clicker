<!doctype html>
<html>
 	 <head>
 	 	<meta charset="utf-8">
		<title>Cat Clicker 0.4</title>
	</head>
	<body>
		<div id="cat-list"> </div>
		<div id="cat-display">
			<h1 id="display-name"></h1>
			<img id="display-img">
			<div> Clicks: <span id="click-count">None</span></div>
		</div>
	</body>

	<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
	<script>

function Cat(index, name) {
	this.index = index;
	this.name = name;
	this.clicks = 0;
}

Cat.prototype.clicked = function() {
	this.clicks += 1;
	console.log(this.name + ' clicked. Count:' + this.clicks);
	// $('#click-count').text(this.clicks);
}

Cat.prototype.clickName = function() {
	console.log(this.name + ' name clicked.');
	// $(`#cat-${this.index}-clicks`).html(this.clicks);
	octopus.selectCat(this);
}

let model = {
	init: function() {
		this.cats = [
			new Cat(0, 'Onesey'),
			new Cat(1, 'Twosey'),
			new Cat(2, 'Threesey'),
			new Cat(3, 'Foursey'),
			new Cat(4, 'Fivesey')
		];
		this.selected_cat = null;
	}
};

let octopus = {
	init: function() {
		model.init();
		view.init();
	},

	getCats: function() {
		return model.cats;
	},

	getSelectedCat: function() {
		return model.selected_cat;
	},

	selectCat: function(cat) {
		model.selected_cat = cat;
		view.renderCatDisplay();
	},

	imageClicked: function() {
		model.selected_cat.clicked();
		view.renderCatDisplay();
	}
};

let view = {
	init: function() {
		this.renderCatList();

		$('#display-img').click(function() {
			console.log('Image clicked');
			octopus.imageClicked();
		});
	},

	renderCatList: function() {
		let cats = octopus.getCats();
		console.log('renderCatList: ' + cats);
		let list_elem = $('#cat-list');
		list_elem.html('');
		cats.forEach(function(cat, index) {
			console.log(cat);
			let item_elem = document.createElement('div');
			let link_elem = document.createElement('a');
			link_elem.setAttribute('href', '#' + cat.index);
			link_elem.textContent = cat.name;
			link_elem.addEventListener('click', function() {
			// console.log(cat.name + ' clicked');
				cat.clickName();
			});
			item_elem.append(link_elem);
			list_elem.append(item_elem);
		});
	},

	renderCatDisplay: function() {
		let selected_cat = octopus.getSelectedCat();
		let image_file = "cat_" + selected_cat.index + ".jpg";
		$('#display-name').html(selected_cat.name);
		$('#display-img').attr('src', image_file);
		$('#click-count').text(selected_cat.clicks);
	}
};

octopus.init();

	</script>
</html>
